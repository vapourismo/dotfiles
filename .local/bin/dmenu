#!/bin/sh

. /etc/profile.d/nix.sh

paths="$(echo $PATH | sed 's/:/\n/g')"

listAll() {
	for path in $paths; do
		test -r $path && ls -1 $path
	done
}

listAllSorted() {
	listAll | sort -u
}

start_dmenu() {
	cat | dmenu -i -b -sb '#96373C' -sf '#d2d2d2' -nb '#111111' -nf '#d2d2d2' -fn 'iosevka-11' -l 5 &
	dmenu_pid=$!

	current_monitor=$(bspc query -M -m focused)
	prev_padding=$(bspc config -m $current_monitor bottom_padding)

	bspc config -m $current_monitor bottom_padding 125
	wait $dmenu_pid
	bspc config -m $current_monitor bottom_padding $prev_padding
}

task() {
	listAllSorted | start_dmenu | ${SHELL:-"/bin/sh"}
}

task&
